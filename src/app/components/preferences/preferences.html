<div class="relative">
  <!-- Trigger -->
  <button
    type="button"
    (click)="toggleMenu()"
    class="flex items-center justify-center w-9 h-9 rounded-lg bg-secondary/50 border border-border
           hover:border-primary/50 hover:bg-primary/10 transition-all text-muted-foreground hover:text-primary"
    aria-label="Preferences"
    aria-haspopup="menu"
    [attr.aria-expanded]="isOpen"
  >
    <i class="fa-solid fa-sliders text-[16px]"></i>
  </button>

  <!-- Dropdown -->
  <div
    *ngIf="isOpen"
    class="absolute right-0 mt-2 w-72 rounded-xl border border-border bg-card shadow-lg overflow-hidden z-50"
    role="menu"
  >
    <div class="px-3 py-2 border-b border-border">
      <p class="font-mono text-xs text-muted-foreground">Options</p>
    </div>

    <div class="p-3 space-y-3">
      <!-- Theme row -->
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-2">
          <i class="fa-solid fa-circle-half-stroke text-muted-foreground text-[14px]"></i>
          <span class="font-mono text-sm text-foreground">Theme</span>
        </div>

        <app-theme (changed)="handleChanged()"></app-theme>
      </div>

      <!-- Language row -->
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-2">
          <i class="fa-solid fa-globe text-muted-foreground text-[14px]"></i>
          <span class="font-mono text-sm text-foreground">Language</span>
        </div>

        <app-language-switch (changed)="handleChanged()"></app-language-switch>
      </div>
    </div>

    <div class="px-3 py-2 border-t border-border">
      <button
        type="button"
        (click)="closeMenu()"
        class="w-full px-3 py-2 rounded-lg bg-secondary/40 hover:bg-secondary/60 transition
               font-mono text-xs text-muted-foreground"
      >
        Close
      </button>
    </div>
  </div>
</div>
